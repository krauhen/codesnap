_Generate LLM-friendly code snapshots_
A modern CLI tool to create clean, structured codebase snapshots for large language models (LLMs), summarization, and context windows.
:toc:
:sectnums:
:icons: font

== Features
- üì¶ Output in Markdown, plain text, or JSON formats
- üìÇ Project directory tree, filtered to relevant files
- üìù Includes all core source/config files, auto-sorted
- üßê Optionally analyzes import dependencies and generates Mermaid diagrams
- ü§ñ Summarize each file with LLMs (OpenAI or Anthropic)
- ‚úÇÔ∏è Copy snapshot to clipboard, save to file, or print to terminal
- üîç Powerful file inclusion and filtering (by glob, extension, search terms, etc.)
- üõ°Ô∏è Token-aware, safe for LLM context limits (OpenAI, Claude, etc.)
- üßëüèª‚Äçüíª Profile and config management, CLI + programmatic use

== Quickstart
----
pip install codesnap
----

.Example: snapshot the current directory and copy to clipboard
----
codesnap . -c
----

.Example: output snapshot from a Python project and include import analysis diagram
----
codesnap path/to/project -l python --analyze-imports --import-diagram
----

.Example: include summaries of each file using OpenAI or Anthropic
----
codesnap . --summarize --llm-provider openai --summary-sentences 2
----

== Usage
.Basic usage
----
codesnap [PATH] [OPTIONS]
----

Most options are auto-detected. Run with `--help` for all options:
----
codesnap --help
----

.Key options
[options="header"]
|===
| Option | Description
| `-l`, `--language` `[python|javascript|typescript]` | Language (auto-detected if omitted)
| `-o`, `--output <file>` | Output file (otherwise prints to terminal)
| `-c`, `--clipboard` | Copy snapshot to clipboard
| `--max-tokens <num>` | Limit output for LLM model context
| `--count-tokens`/`--no-count-tokens` | Enable or disable token counting (for speed tradeoff)
| `--no-tree` | Omit directory tree in output
| `--tree-depth <int>` | Limit directory tree recursion
| `--tree-style` `[ascii, unicode]` | Directory tree drawing style
| `--ignore <glob>` | Add ignore pattern
| `--include <glob>` | Explicitly include files by pattern
| `--exclude <glob>` | Explicitly exclude files by pattern
| `--include-ext <.ext>` | Additional file extensions to include
| `--search-term <kw>` | Files containing these keywords (filename)
| `--format` `[markdown, text, json]` | Output format
| `--max-file-lines`, `--max-line-length` | Limit file output size
| `--profile <name>` | Load settings from config profile
| `--save-profile <name>` | Save options to config profile
| `--summarize` | Summarize all files with LLM
| `--llm-provider` `[auto, openai, anthropic]` | LLM to use for summarization
| `--summary-sentences <n>` | Number of sentences per file summary (with `--summarize`)
| `--analyze-imports` | Analyze internal/external imports
| `--import-diagram` | Generate a Mermaid import diagram
|===

== Import/Dependency Analysis
Add deep project context for LLMs! Use `--analyze-imports` to include:
- Internal/external dependencies
- Orphaned files, circular dependencies
- Mermaid diagrams (`--import-diagram`)

== LLM Summarization
Summarize files with OpenAI or Anthropic (Claude):
- Set your `OPENAI_API_KEY` or `ANTHROPIC_API_KEY` as environment variables
- Use `--summarize --llm-provider <provider>`

.Example (with OpenAI, 2 sentences per file)
----
OPENAI_API_KEY=sk-... codesnap . --summarize --summary-sentences 2
----

== Configuration & Profiles
- Place config in `codesnap.json` at project root or `~/.config/codesnap/config.json`
- Supports multiple named "profiles" for fast switching

.Save CLI options to a profile:
----
codesnap . --max-file-lines 30 --save-profile short
----

.Load from a profile:
----
codesnap . --profile short
----

== Programmatic API
Use `codesnap` as a library:
[source,python]
----
from codesnap import CodeSnapshotter, Config, Language
snap = CodeSnapshotter(
    root_path=Path("myproject"),
    language=Language.PYTHON,
    config=Config(max_file_lines=50)
)
result = snap.create_snapshot(max_tokens=4096)
print(result.content)
----

== Requirements
- Python 3.8+
- Optional: `httpx` if using LLM summarization (`pip install httpx`)

== Development
- Main code lives in the `codesnap/` directory
- For CLI dev, use `python -m codesnap.main`
- Contributions welcome!

== License
MIT License.

== Author
Henning Krause
<henning.krause90@googlemail.com>

'''